@model List<Supermarket_Managment_System.Models.bill_items_details>

<h2>Bill Items</h2>

<table>
    <tr>
        <th>Product Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Actions</th>
    </tr>
    @foreach (var item in Model)
    {
        <tr>
            <td>@item.Product.Name</td>
            <td>@item.Product.Price</td>
            <td>
                <form id="updateForm_@item.Id">
                    <input type="hidden" name="billItemId" value="@item.Id" />
                    <input type="number" name="quantity" value="@item.Quantity" />
                    <button type="button" onclick="updateQuantity('@item.Id')">Update</button>
                </form>
            </td>
            <td>
                <button type="button" onclick="deleteItem('@item.Id')">Remove</button>
            </td>
        </tr>
    }
</table>

<script>
    function updateQuantity(billItemId) {
        var quantity = $('#updateForm_' + billItemId + ' input[name="quantity"]').val();

        $.ajax({
            type: 'POST',
            url: '@Url.Action("UpdateQuantity", "Casher")',
            data: {
                billItemId: billItemId,
                quantity: quantity
            },
            success: function () {
                location.reload(); // Refresh the page after successful update
            },
            error: function () {
                alert('Failed to update quantity.');
            }
        });
    }

    function deleteItem(billItemId) {
        if (confirm('Are you sure you want to remove this item?')) {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("DeleteItem", "Casher")',
                data: {
                    id: billItemId
                },
                success: function () {
                    location.reload(); // Refresh the page after successful deletion
                },
                error: function () {
                    alert('Failed to delete item.');
                }
            });
        }
    }
</script>
